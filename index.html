<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2811308505659881"
     crossorigin="anonymous"></script>
    <title>News Scraper App with Pexels</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #f0f0f0;
        }
        header {
            background-color: lightseagreen;
            padding: 10px;
            color: white;
            text-align: center;
            position: relative;
        }
        .hamburger {
            font-size: 30px;
            cursor: pointer;
            position: absolute;
            left: 10px;
            top: 10px;
        }
        #mySidebar {
            height: 100%;
            width: 0;
            position: fixed;
            z-index: 1;
            top: 0;
            left: 0;
            background-color: #111;
            overflow-x: hidden;
            transition: 0.5s;
            padding-top: 60px;
        }
        #mySidebar a {
            padding: 8px 8px 8px 32px;
            text-decoration: none;
            font-size: 25px;
            color: #818181;
            display: block;
            transition: 0.3s;
        }
        #mySidebar a:hover {
            color: white;
        }
        .closebtn {
            font-size: 30px;
            position: absolute;
            top: 0;
            right: 25px;
        }
        .timeline-container {
            padding: 20px;
        }
        .stories-container {
            display: flex;
            overflow-x: auto;
            padding: 10px 0;
            margin-bottom: 20px;
        }
        .story-item {
            margin-right: 10px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            width: 200px;
            cursor: pointer;
        }
        .story-item img {
            width: 100%;
            border-radius: 5px 5px 0 0;
        }
        .story-title {
            padding: 10px;
            font-weight: bold;
        }
        .news-article {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .news-article img {
            width: 100%;
            border-radius: 5px;
        }
        .news-article h3 {
            margin: 0;
        }
        .news-article p {
            margin: 5px 0;
        }
        .news-article a {
            text-decoration: none;
            color: lightseagreen;
        }
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }
        .modal-content {
            position: relative;
            max-width: 600px;
            background: white;
            border-radius: 10px;
            padding: 20px;
        }
        .modal-content img {
            width: 100%;
            border-radius: 5px;
        }
        .modal-content h3 {
            margin: 0;
        }
    </style>
</head>
<body>

<header>
    <span class="hamburger" onclick="openSidebar()">&#9776;</span>
    <h2>Latest News</h2>
</header>

<div id="mySidebar" class="sidebar">
    <a href="javascript:void(0)" class="closebtn" onclick="closeSidebar()">&times;</a>
    <a href="#" onclick="fetchNews('World')">World</a>
    <a href="#" onclick="fetchNews('Technology')">Technology</a>
    <a href="#" onclick="fetchNews('Sports')">Sports</a>
    <a href="#" onclick="fetchNews('Health')">Health</a>
    <a href="#" onclick="fetchNews('Science')">Science</a>
    <a href="#" onclick="fetchNews('Business')">Business</a>
    <a href="#" onclick="fetchNews('Entertainment')">Entertainment</a>
    <a href="#" onclick="fetchNews('Lifestyle')">Lifestyle</a>
</div>

<div class="timeline-container">
    <div class="stories-container" id="stories-container"></div>
    <div id="timeline"></div>
</div>

<script>
    const apiKey = 'NiVHvueLaoALYd41z3fyKZwNBFrWAd3Kqsj8GX14TyYfM0jP1rtmJdMH'; // Replace with your actual Pexels API key

    const rssFeeds = {
        'World': 'https://rss.nytimes.com/services/xml/rss/nyt/World.xml',
        'Technology': 'https://rss.nytimes.com/services/xml/rss/nyt/Technology.xml',
        'Sports': 'https://rss.nytimes.com/services/xml/rss/nyt/Sports.xml',
        'Health': 'https://rss.nytimes.com/services/xml/rss/nyt/Health.xml',
        'Science': 'https://rss.nytimes.com/services/xml/rss/nyt/Science.xml',
        'Business': 'https://rss.nytimes.com/services/xml/rss/nyt/Business.xml',
        'Entertainment': 'https://rss.nytimes.com/services/xml/rss/nyt/Arts.xml',
        'Lifestyle': 'https://rss.nytimes.com/services/xml/rss/nyt/Health.xml'
    };

    function fetchNews(category) {
        const rssUrl = rssFeeds[category];
        fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(rssUrl)}`)
            .then(response => response.json())
            .then(data => {
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(data.contents, "text/xml");
                const items = xmlDoc.querySelectorAll("item");

                // Clear previous stories and timeline
                const storiesContainer = document.getElementById('stories-container');
                const timelineContainer = document.getElementById('timeline');
                storiesContainer.innerHTML = '';
                timelineContainer.innerHTML = '';

                // Display the first 5 items as stories
                for (let i = 0; i < Math.min(items.length, 5); i++) {
                    const item = items[i];
                    const title = item.querySelector("title").textContent;

                    // Fetch Pexels image based on the title
                    fetchImageFromPexels(title).then(media => {
                        const storyItem = document.createElement('div');
                        storyItem.className = 'story-item';
                        storyItem.onclick = () => {
                            openStoryModal(title, media, item.querySelector("link").textContent);
                        };
                        storyItem.innerHTML = `
                            <img src="${media}" alt="${title}">
                            <div class="story-title">${title}</div>
                        `;
                        storiesContainer.appendChild(storyItem);
                    });
                }

                // Display the remaining items as news articles
                for (let i = 5; i < items.length; i++) {
                    const item = items[i];
                    const title = item.querySelector("title").textContent;
                    const description = item.querySelector("description").textContent;
                    const link = item.querySelector("link").textContent;

                    // Fetch Pexels image based on the title
                    fetchImageFromPexels(title).then(media => {
                        const newsArticle = document.createElement('div');
                        newsArticle.className = 'news-article';
                        newsArticle.innerHTML = `
                            <img src="${media}" alt="${title}">
                            <h3>${title}</h3>
                            <p>${description}</p>
                            <a href="${link}" target="_blank">Read more</a>
                        `;
                        timelineContainer.appendChild(newsArticle);
                    });
                }
            })
            .catch(error => {
                console.error('Error fetching news:', error);
                document.getElementById('timeline').innerHTML = 'Failed to load news.';
            });
    }
    // Function to fetch images from Pexels API based on the search term (news title)
    function fetchImageFromPexels(query) {
        return fetch(`https://api.pexels.com/v1/search?query=${query}&per_page=1`, {
            headers: {
                Authorization: apiKey
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.photos.length > 0) {
                return data.photos[0].src.medium; // Return the medium-sized image URL
            } else {
                return 'https://via.placeholder.com/200?text=No+Image'; // Fallback if no image is found
            }
        })
        .catch(error => {
            console.error('Error fetching image from Pexels:', error);
            return 'https://via.placeholder.com/200?text=No+Image'; // Fallback in case of error
        });
    }

    // Open the modal to display the story with the image and link
    function openStoryModal(title, imageUrl, link) {
        const modalHTML = `
            <div class="modal" onclick="closeModal()">
                <div class="modal-content" onclick="event.stopPropagation()">
                    <span class="closebtn" onclick="closeModal()">&times;</span>
                    <img src="${imageUrl}" alt="${title}">
                    <h3>${title}</h3>
                    <a href="${link}" target="_blank">Read more</a>
                </div>
            </div>
        `;
        document.body.insertAdjacentHTML('beforeend', modalHTML);
    }

    // Close the modal
    function closeModal() {
        const modal = document.querySelector('.modal');
        if (modal) {
            modal.remove();
        }
    }

    // Open the sidebar menu
    function openSidebar() {
        document.getElementById("mySidebar").style.width = "250px";
    }

    // Close the sidebar menu
    function closeSidebar() {
        document.getElementById("mySidebar").style.width = "0";
    }
</script>

</body>
</html>
